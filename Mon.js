var table = ee.FeatureCollection("users/BiswasS/Mon_TS"),
    geometry = 
    /* color: #d63000 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[96.8834533288292, 17.594568136344993],
              [96.8834533288292, 17.593617028987744],
              [96.88460667870561, 17.593617028987744],
              [96.88460667870561, 17.594568136344993]]], null, false),
        {
          "Class": "Rubber",
          "system:index": "0"
        }),
    geometry2 = 
    /* color: #0b4a8b */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[96.93871756337205, 17.597242459770154],
              [96.93871756337205, 17.594757334523344],
              [96.94230099461595, 17.594757334523344],
              [96.94230099461595, 17.597242459770154]]], null, false),
        {
          "Class": "Rubber",
          "system:index": "0"
        }),
    geometry3 = 
    /* color: #ffc82d */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[96.93925400517503, 17.54886586455914],
              [96.93925400517503, 17.5477815324551],
              [96.9409062459282, 17.5477815324551],
              [96.9409062459282, 17.54886586455914]]], null, false),
        {
          "Class": "Rubber",
          "system:index": "0"
        }),
    geometry4 = 
    /* color: #00ffff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[96.99410517952958, 17.403258131032956],
              [96.99410517952958, 17.398733009159454],
              [96.99981292031327, 17.398733009159454],
              [96.99981292031327, 17.403258131032956]]], null, false),
        {
          "Class": "Rubber",
          "system:index": "0"
        }),
    geometry5 = 
    /* color: #ff0000 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.08323498509446, 17.33103990990007],
              [97.08323498509446, 17.32867405222167],
              [97.08582063458482, 17.32867405222167],
              [97.08582063458482, 17.33103990990007]]], null, false),
        {
          "Class": "Rubber",
          "system:index": "0"
        }),
    geometry6 = 
    /* color: #00ff00 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.4674399688057, 16.513334685637776],
              [97.4674399688057, 16.510567648362287],
              [97.47181733391801, 16.510567648362287],
              [97.47181733391801, 16.513334685637776]]], null, false),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    geometry7 = 
    /* color: #0000ff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.38533755085984, 16.5180277577197],
              [97.38533755085984, 16.517343733487667],
              [97.38651235840837, 16.517343733487667],
              [97.38651235840837, 16.5180277577197]]], null, false),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    geometry8 = 
    /* color: #999900 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.51041834495584, 16.50329048558579],
              [97.51041834495584, 16.5024418190333],
              [97.51141612670938, 16.5024418190333],
              [97.51141612670938, 16.50329048558579]]], null, false),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    geometry9 = 
    /* color: #009999 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.64567678115884, 16.51353591147808],
              [97.64567678115884, 16.513049883211753],
              [97.64644925735513, 16.513049883211753],
              [97.64644925735513, 16.51353591147808]]], null, false),
        {
          "Class": "Coconut",
          "system:index": "0"
        }),
    geometry10 = 
    /* color: #ff00ff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.63602887533227, 16.54013316506582],
              [97.63602887533227, 16.539361797311898],
              [97.63735656879464, 16.539361797311898],
              [97.63735656879464, 16.54013316506582]]], null, false),
        {
          "Class": "Coconut",
          "system:index": "0"
        }),
    geometry11 = 
    /* color: #99ff99 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.53447910092393, 16.424561482029567],
              [97.53447910092393, 16.423244226639316],
              [97.53710766575853, 16.423244226639316],
              [97.53710766575853, 16.424561482029567]]], null, false),
        {
          "Class": "Rubber",
          "system:index": "0"
        }),
    geometry12 = 
    /* color: #9999ff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.59786640546838, 16.351138555637785],
              [97.59786640546838, 16.350559466547548],
              [97.59864156387368, 16.350559466547548],
              [97.59864156387368, 16.351138555637785]]], null, false),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    geometry13 = 
    /* color: #ffff99 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.6103319718651, 16.326102967565543],
              [97.6103319718651, 16.324903454176784],
              [97.61160870335618, 16.324903454176784],
              [97.61160870335618, 16.326102967565543]]], null, false),
        {
          "system:index": "0",
          "Class": "Mangrove"
        }),
    geometry14 = 
    /* color: #ff99ff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.68410881302873, 16.371552922024616],
              [97.68410881302873, 16.3700294299634],
              [97.68578251145402, 16.3700294299634],
              [97.68578251145402, 16.371552922024616]]], null, false),
        {
          "Class": "Rubber",
          "system:index": "0"
        }),
    geometry15 = 
    /* color: #d63000 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.84737487576524, 16.15950121951196],
              [97.84737487576524, 16.156507609839636],
              [97.85022338173906, 16.156507609839636],
              [97.85022338173906, 16.15950121951196]]], null, false),
        {
          "Class": "Rubber",
          "system:index": "0"
        }),
    geometry16 = 
    /* color: #98ff00 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[98.15814365885774, 15.044283099363666],
              [98.15814365885774, 15.041299078635452],
              [98.16328277133027, 15.041299078635452],
              [98.16328277133027, 15.044283099363666]]], null, false),
        {
          "system:index": "0",
          "Class": "Upland_Evergreen"
        }),
    geometry17 = 
    /* color: #0b4a8b */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[98.17918290637056, 15.000653183255185],
              [98.17918290637056, 14.997585645712014],
              [98.18425764582673, 14.997585645712014],
              [98.18425764582673, 15.000653183255185]]], null, false),
        {
          "system:index": "0",
          "Class": "Upland_Evergreen"
        }),
    geometry18 = 
    /* color: #ffc82d */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[98.1702940656952, 15.19982928989072],
              [98.1702940656952, 15.174399531792421],
              [98.20454051039735, 15.174399531792421],
              [98.20454051039735, 15.19982928989072]]], null, false),
        {
          "system:index": "0",
          "Class": "Upland_Evergreen"
        }),
    geometry19 = 
    /* color: #00ffff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[98.05349995635072, 15.089028034706978],
              [98.05349995635072, 15.083900301211484],
              [98.0589180185608, 15.083900301211484],
              [98.0589180185608, 15.089028034706978]]], null, false),
        {
          "system:index": "0",
          "Class": "MDF"
        }),
    geometry20 = 
    /* color: #bf04c2 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.79468287966768, 15.009223401170054],
              [97.79468287966768, 15.006508326997855],
              [97.79834141276399, 15.006508326997855],
              [97.79834141276399, 15.009223401170054]]], null, false),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    geometry21 = 
    /* color: #ff0000 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.80116309664766, 15.070330634069554],
              [97.80116309664766, 15.06910816902853],
              [97.80195703051606, 15.06910816902853],
              [97.80195703051606, 15.070330634069554]]], null, false),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    geometry22 = 
    /* color: #00ff00 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.80746092341462, 15.143158208142578],
              [97.80746092341462, 15.1422986343804],
              [97.80806710265199, 15.1422986343804],
              [97.80806710265199, 15.143158208142578]]], null, false),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    geometry23 = 
    /* color: #0000ff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.30087747118989, 17.591644487959872],
              [97.30087747118989, 17.58787064888421],
              [97.30661739848176, 17.58787064888421],
              [97.30661739848176, 17.591644487959872]]], null, false),
        {
          "Class": "MDF",
          "system:index": "0"
        }),
    geometry24 = 
    /* color: #999900 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.3956667377762, 17.71358696220742],
              [97.3956667377762, 17.707086813128065],
              [97.40328421137849, 17.707086813128065],
              [97.40328421137849, 17.71358696220742]]], null, false),
        {
          "Class": "MDF",
          "system:index": "0"
        }),
    geometry25 = 
    /* color: #009999 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.34056880019227, 17.649834972841376],
              [97.34056880019227, 17.64662467074717],
              [97.3449676229767, 17.64662467074717],
              [97.3449676229767, 17.649834972841376]]], null, false),
        {
          "Class": "MDF",
          "system:index": "0"
        }),
    geometry26 = 
    /* color: #ff00ff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.35103477976838, 17.317481903297242],
              [97.35103477976838, 17.315889187933347],
              [97.35362042925874, 17.315889187933347],
              [97.35362042925874, 17.317481903297242]]], null, false),
        {
          "Class": "MDF",
          "system:index": "0"
        }),
    geometry27 = 
    /* color: #ff9999 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.32163658930422, 17.352586031915912],
              [97.32163658930422, 17.351014102356743],
              [97.32401839090944, 17.351014102356743],
              [97.32401839090944, 17.352586031915912]]], null, false),
        {
          "Class": "MDF",
          "system:index": "0"
        }),
    image = ee.Image("users/BiswasS/classified_Mon_Set1"),
    image3 = ee.Image("users/BiswasS/nf_mask"),
    geometry28 = 
    /* color: #99ff99 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.69766469739, 16.032084708065174],
              [97.69766469739, 16.031589752498533],
              [97.69845326684037, 16.031589752498533],
              [97.69845326684037, 16.032084708065174]]], null, false),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    geometry29 = 
    /* color: #9999ff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.70131786606828, 16.026392644878573],
              [97.70131786606828, 16.026085866932018],
              [97.70166118882219, 16.026085866932018],
              [97.70166118882219, 16.026392644878573]]], null, false),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    geometry30 = 
    /* color: #ffff99 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.64854808590928, 16.048052810370667],
              [97.64854808590928, 16.046954714032424],
              [97.6497228934578, 16.046954714032424],
              [97.6497228934578, 16.048052810370667]]], null, false),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    geometry31 = 
    /* color: #99ffff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.79666503212968, 16.135128519368703],
              [97.79666503212968, 16.133273391811734],
              [97.80034502289811, 16.133273391811734],
              [97.80034502289811, 16.135128519368703]]], null, false),
        {
          "Class": "Rubber",
          "system:index": "0"
        }),
    geometry32 = 
    /* color: #ff99ff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.81294067643205, 16.127345885171852],
              [97.81294067643205, 16.1266038070819],
              [97.81357367775956, 16.1266038070819],
              [97.81357367775956, 16.127345885171852]]], null, false),
        {
          "Class": "Rubber",
          "system:index": "0"
        }),
    geometry33 = 
    /* color: #d63000 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.81851967118303, 16.13247851586751],
              [97.81851967118303, 16.130324476205963],
              [97.82085855744401, 16.130324476205963],
              [97.82085855744401, 16.13247851586751]]], null, false),
        {
          "Class": "Rubber",
          "system:index": "0"
        }),
    geometry34 = 
    /* color: #98ff00 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.7993526055626, 16.137544023998235],
              [97.7993526055626, 16.135178762165342],
              [97.80084391377488, 16.135178762165342],
              [97.80084391377488, 16.137544023998235]]], null, false),
        {
          "Class": "Rubber",
          "system:index": "0"
        }),
    geometry35 = 
    /* color: #0b4a8b */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.82466192982713, 15.869477514022021],
              [97.82466192982713, 15.867537357999048],
              [97.82814880154649, 15.867537357999048],
              [97.82814880154649, 15.869477514022021]]], null, false),
        {
          "Class": "Rubber",
          "system:index": "0"
        }),
    geometry36 = 
    /* color: #ffc82d */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[98.1384696557335, 15.08525346512107],
              [98.1384696557335, 15.079845937495858],
              [98.14276119015733, 15.079845937495858],
              [98.14276119015733, 15.08525346512107]]], null, false),
        {
          "system:index": "0",
          "Class": "MDF"
        }),
    geometry37 = 
    /* color: #00ffff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[98.16255589268724, 15.127501508994806],
              [98.16255589268724, 15.12642437255344],
              [98.16461046479264, 15.12642437255344],
              [98.16461046479264, 15.127501508994806]]], null, false),
        {
          "Class": "MDF",
          "system:index": "0"
        }),
    geometry38 = 
    /* color: #bf04c2 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.91017611763994, 15.547423560649248],
              [97.91017611763994, 15.54613152453692],
              [97.91127045891801, 15.54613152453692],
              [97.91127045891801, 15.547423560649248]]], null, false),
        {
          "Class": "Rubber",
          "system:index": "0"
        }),
    geometry39 = 
    /* color: #ff0000 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.91197856209794, 15.548263379775483],
              [97.91197856209794, 15.545937718420973],
              [97.91585167191545, 15.545937718420973],
              [97.91585167191545, 15.548263379775483]]], null, false),
        {
          "Class": "Rubber",
          "system:index": "0"
        }),
    geometry40 = 
    /* color: #00ff00 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.90225287220994, 15.546702605498162],
              [97.90225287220994, 15.545405396684146],
              [97.90469904683152, 15.545405396684146],
              [97.90469904683152, 15.546702605498162]]], null, false),
        {
          "Class": "Rubber",
          "system:index": "0"
        }),
    geometry41 = 
    /* color: #0000ff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.90285905144731, 15.544568150003771],
              [97.90285905144731, 15.538490257276743],
              [97.91680653832475, 15.538490257276743],
              [97.91680653832475, 15.544568150003771]]], null, false),
        {
          "Class": "Rubber",
          "system:index": "0"
        }),
    geometry42 = 
    /* color: #999900 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.80900319359819, 15.520911941462305],
              [97.80900319359819, 15.51978514151077],
              [97.81025310299913, 15.51978514151077],
              [97.81025310299913, 15.520911941462305]]], null, false),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    geometry43 = 
    /* color: #009999 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.81874497674028, 15.515378674361529],
              [97.81874497674028, 15.514885040802794],
              [97.81942894003907, 15.514885040802794],
              [97.81942894003907, 15.515378674361529]]], null, false),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    geometry44 = 
    /* color: #ff00ff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.83311625264207, 15.514625301204909],
              [97.83311625264207, 15.513870633056026],
              [97.83459683201829, 15.513870633056026],
              [97.83459683201829, 15.514625301204909]]], null, false),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    geometry45 = 
    /* color: #ff9999 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.84065594218293, 15.517331229039193],
              [97.84065594218293, 15.517054693629353],
              [97.841028769236, 15.517054693629353],
              [97.841028769236, 15.517331229039193]]], null, false),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    geometry46 = 
    /* color: #99ff99 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.81378557227174, 15.52949325154037],
              [97.81378557227174, 15.528490544979709],
              [97.81484772704164, 15.528490544979709],
              [97.81484772704164, 15.52949325154037]]], null, false),
        {
          "system:index": "0",
          "Class": "Mangrove"
        }),
    geometry48 = 
    /* color: #ffff99 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.77250369332353, 15.549334467199222],
              [97.77250369332353, 15.548657447569648],
              [97.77292480013887, 15.548657447569648],
              [97.77292480013887, 15.549334467199222]]], null, false),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    geometry47 = 
    /* color: #99ffff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.79700835488359, 15.533027236427003],
              [97.79700835488359, 15.532164096897693],
              [97.79824753544847, 15.532164096897693],
              [97.79824753544847, 15.533027236427003]]], null, false),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    geometry49 = 
    /* color: #ff99ff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.56079693577806, 16.22254712264298],
              [97.56079693577806, 16.22189039105336],
              [97.56163914940873, 16.22189039105336],
              [97.56163914940873, 16.22254712264298]]], null, false),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    geometry50 = 
    /* color: #d63000 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.52007563851396, 16.221613532962277],
              [97.52007563851396, 16.220988991188033],
              [97.52029423854867, 16.220988991188033],
              [97.52029423854867, 16.221613532962277]]], null, false),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    image2 = ee.Image("users/BiswasS/classified_Mon_Set2_masked"),
    geometry51 = 
    /* color: #d63000 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[98.16346516154329, 14.98599648565251],
              [98.16346516154329, 14.983239660337672],
              [98.16653360865632, 14.983239660337672],
              [98.16653360865632, 14.98599648565251]]], null, false),
        {
          "Class": "Upland_Evergreen",
          "system:index": "0"
        }),
    table3 = ee.FeatureCollection("users/BiswasS/Mon_masked_area"),
    geometry52 = /* color: #98ff00 */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.99925227902452, 15.09500764441224],
              [97.99971093676606, 15.095466013784879],
              [97.99926300786058, 15.095823385829881],
              [97.99875338814775, 15.095468603439537]]]),
        {
          "Class": "Lowland_Evergreen",
          "system:index": "0"
        }),
    geometry53 = /* color: #0b4a8b */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.99826522610704, 15.094953261539677],
              [97.99851735375444, 15.095207048159176],
              [97.99814452670137, 15.095455655165914],
              [97.99794872544328, 15.095310634447333],
              [97.99797554753343, 15.09512417909226]]]),
        {
          "Class": "Bamboo",
          "system:index": "0"
        }),
    geometry54 = /* color: #ffc82d */ee.Feature(
        ee.Geometry.Polygon(
            [[[98.00284643910447, 15.094994696110513],
              [98.00403197548906, 15.095813027228333],
              [98.00359209321061, 15.096491514562015],
              [98.00264795563737, 15.096719402951209],
              [98.00187011502305, 15.09612378505475]]]),
        {
          "Class": "Bamboo",
          "system:index": "0"
        }),
    geometry55 = /* color: #00ffff */ee.Feature(
        ee.Geometry.Polygon(
            [[[98.0062743022255, 15.096934342912423],
              [98.00691266797105, 15.097524779276755],
              [98.00637086175004, 15.0980893177743],
              [98.0055179192833, 15.097379759970917]]]),
        {
          "Class": "Upland_Evergreen",
          "system:index": "0"
        }),
    geometry56 = /* color: #bf04c2 */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.9626159860901, 15.087797907899835],
              [97.96554495833436, 15.08861108726042],
              [97.96464373610536, 15.089160111056383],
              [97.96280374072114, 15.088580010399356]]]),
        {
          "Class": "MDF",
          "system:index": "0"
        }),
    geometry57 = /* color: #ff0000 */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.94427235863725, 15.069264862503156],
              [97.94439842246095, 15.069065434424072],
              [97.94501533053437, 15.069272632424534],
              [97.94542570851365, 15.06973623721988],
              [97.94515748761216, 15.069951204463791]]]),
        {
          "Class": "MDF",
          "system:index": "0"
        }),
    geometry58 = /* color: #00ff00 */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.94290443203965, 15.069435800707907],
              [97.94327725909272, 15.068897085900135],
              [97.94406046412507, 15.069583429046963],
              [97.94357766650239, 15.070013363626385],
              [97.94313778422395, 15.069694797726205]]]),
        {
          "Class": "Upland_Evergreen",
          "system:index": "0"
        }),
    geometry59 = /* color: #0000ff */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.93964554808656, 15.066557027626887],
              [97.9407881691269, 15.066743508034312],
              [97.94043948195497, 15.067385828187046],
              [97.93962945483247, 15.067328848251845]]]),
        {
          "Class": "Rubber",
          "system:index": "0"
        }),
    geometry60 = /* color: #999900 */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.91914542458574, 15.07351237720536],
              [97.92013247750322, 15.074983447892556],
              [97.9189415767006, 15.075781136898645],
              [97.91797598145524, 15.074817693957472]]]),
        {
          "Class": "MDF",
          "system:index": "0"
        }),
    geometry61 = /* color: #009999 */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.90379782460252, 15.073714391259783],
              [97.90403117678682, 15.073779139241857],
              [97.90399094365159, 15.074051080551381],
              [97.90380587122957, 15.07402000156217]]]),
        {
          "Class": "Bamboo",
          "system:index": "0"
        }),
    geometry62 = /* color: #ff00ff */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.90127654812852, 15.073761009808871],
              [97.90263911030809, 15.073230075728857],
              [97.9034330441765, 15.074139137662812],
              [97.90174861691514, 15.074260863609771]]]),
        {
          "Class": "Lowland_Evergreen",
          "system:index": "0"
        }),
    geometry63 = /* color: #ff9999 */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.900281448584, 15.07558171515128],
              [97.90097077630082, 15.075625743394754],
              [97.90088494561235, 15.07623954795739],
              [97.90021975777665, 15.076211059177231]]]),
        {
          "Class": "Lowland_Evergreen",
          "system:index": "0"
        }),
    geometry64 = /* color: #99ff99 */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.90017147801439, 15.074859132677075],
              [97.90015002034227, 15.074727047443323],
              [97.90034045718232, 15.074716687813677],
              [97.90053625844041, 15.074807334555961],
              [97.90034045718232, 15.075027476483562],
              [97.9001553847603, 15.075055965422253],
              [97.90002663872758, 15.074960138976957]]]),
        {
          "Class": "Bamboo",
          "system:index": "0"
        }),
    geometry65 = 
    /* color: #9999ff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.88706084034959, 15.082354187822071],
              [97.88706084034959, 15.081214666404339],
              [97.88860042832414, 15.081214666404339],
              [97.88860042832414, 15.082354187822071]]], null, false),
        {
          "Class": "Lowland_Evergreen",
          "system:index": "0"
        }),
    geometry66 = 
    /* color: #ffff99 */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.87289341233293, 15.044174307898489],
              [97.87289341233293, 15.042630496045643],
              [97.87493189118425, 15.042630496045643],
              [97.87493189118425, 15.044174307898489]]], null, false),
        {
          "Class": "Lowland_Evergreen",
          "system:index": "0"
        }),
    geometry67 = 
    /* color: #99ffff */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Feature(
        ee.Geometry.Polygon(
            [[[97.94253696940461, 15.06361605459589],
              [97.94253696940461, 15.062041302884484],
              [97.94364740393678, 15.062041302884484],
              [97.94364740393678, 15.06361605459589]]], null, false),
        {
          "Class": "Lowland_Evergreen",
          "system:index": "0"
        }),
    geometry68 = /* color: #ff99ff */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.93781091712037, 15.060927573425198],
              [97.939184208136, 15.062025762513505],
              [97.93873896143953, 15.06288566133603],
              [97.93734957716981, 15.062631836141263]]]),
        {
          "Class": "Lowland_Evergreen",
          "system:index": "0"
        }),
    geometry69 = /* color: #d63000 */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.93638398192445, 15.063792177418323],
              [97.93729593298951, 15.064734950049006],
              [97.93651272795717, 15.065268495346984],
              [97.93557931921998, 15.064543287819363]]]),
        {
          "Class": "Lowland_Evergreen",
          "system:index": "0"
        }),
    geometry70 = /* color: #98ff00 */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.87717153571168, 15.067703102547235],
              [97.8771393492035, 15.068935935571334],
              [97.87493993781129, 15.068946295482446],
              [97.87496139548341, 15.067817062201966]]]),
        {
          "Class": "Upland_Evergreen",
          "system:index": "0"
        }),
    geometry71 = 
    /* color: #0b4a8b */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[97.87127067587892, 15.032263872363325],
          [97.87205388091127, 15.032315680829688],
          [97.87261178038636, 15.03351763371764],
          [97.87247230551759, 15.034833557130964],
          [97.87095953963319, 15.034792110848054]]]),
    geometry72 = /* color: #ffc82d */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.86514182827989, 14.99954301955435],
              [97.86742707036058, 14.999657015625786],
              [97.86710520527879, 15.00141876536605],
              [97.86517401478807, 15.001263317443456]]]),
        {
          "Class": "Lowland_Evergreen",
          "system:index": "0"
        }),
    geometry73 = /* color: #00ffff */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.86197682164232, 14.964667734196512],
              [97.86502381108323, 14.964543354517598],
              [97.86443372509996, 14.965631674261028],
              [97.86470194600145, 14.967072393802791],
              [97.86232014439622, 14.967072393802791]]]),
        {
          "Class": "Lowland_Evergreen",
          "system:index": "0"
        }),
    geometry74 = /* color: #d63000 */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.59465446017305, 16.231168131272455],
              [97.60864486239473, 16.23990335813083],
              [97.60443915865937, 16.251851860941215],
              [97.59019126437227, 16.241469065350604]]]),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    geometry75 = /* color: #98ff00 */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.58190457962075, 16.240121605073917],
              [97.5856596722416, 16.239956793245476],
              [97.5857669606022, 16.24350021712249],
              [97.58203332565347, 16.24362382377979]]]),
        {
          "Class": "Mangrove",
          "system:index": "0"
        }),
    geometry76 = /* color: #d63000 */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.34406908295671, 17.675198435650945],
              [97.34462430022279, 17.675195880060958],
              [97.34462430022279, 17.675543439965868],
              [97.34406371853868, 17.675535773210513]]]),
        {
          "Class": "Bamboo",
          "system:index": "0"
        }),
    geometry77 = /* color: #98ff00 */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.34670301220933, 17.675738942117153],
              [97.34707315705339, 17.675749164446017],
              [97.34707315705339, 17.67610694558989],
              [97.34668155453721, 17.676112056743936]]]),
        {
          "Class": "Bamboo",
          "system:index": "0"
        }),
    tcc = ee.Image("users/pawlokdass/Sumalika/tcc_myanmar_calib_2018_wgs84_bd"),
    table2 = ee.FeatureCollection("users/pawlokdass/Sumalika/Mon"),
    geometry78 = /* color: #d63000 */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.15231525751018, 17.510139197372546],
              [97.15549099298381, 17.510261977751814],
              [97.15544807763958, 17.512103673479476],
              [97.15229379983806, 17.512021820732638]]]),
        {
          "Class": "Upland_Evergreen",
          "system:index": "0"
        }),
    geometry79 = /* color: #98ff00 */ee.Feature(
        ee.Geometry.Polygon(
            [[[96.9832180723753, 17.597426569843748],
              [96.98583590837383, 17.597426569843748],
              [96.98562133165264, 17.60145587311277],
              [96.98287474962139, 17.60137406074245]]]),
        {
          "Class": "Rubber",
          "system:index": "0"
        }),
    geometry80 = /* color: #0b4a8b */ee.Feature(
        ee.Geometry.Polygon(
            [[[96.99871051164531, 17.599044949279772],
              [96.99876952024364, 17.598237039714974],
              [96.99963319154644, 17.59834697698841],
              [96.99959832282924, 17.59905517595997],
              [96.99877488466167, 17.599042392609633]]]),
        {
          "Class": "Bamboo",
          "system:index": "0"
        }),
    geometry81 = /* color: #ffc82d */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.02875393482113, 17.5661849164521],
              [97.02951031776333, 17.56622327347015],
              [97.02941912265682, 17.567235895806594],
              [97.02868956180477, 17.56720265324408]]]),
        {
          "Class": "Bamboo",
          "system:index": "0"
        }),
    geometry82 = /* color: #00ffff */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.21988814922237, 17.529946691270272],
              [97.2207947358694, 17.529949248916537],
              [97.22080278249645, 17.530785597314193],
              [97.21995252223873, 17.530783039679704]]]),
        {
          "Class": "Bamboo",
          "system:index": "0"
        }),
    geometry83 = /* color: #bf04c2 */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.21520769449138, 17.53023954153435],
              [97.21606868358516, 17.53024721446067],
              [97.21607136579418, 17.531001717297563],
              [97.2151916012373, 17.53097869861338]]]),
        {
          "Class": "Bamboo",
          "system:index": "0"
        }),
    geometry84 = /* color: #ff0000 */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.12095486970806, 17.483037235316143],
              [97.12390529962444, 17.48298606917141],
              [97.12401258798504, 17.48609694460635],
              [97.12122309060955, 17.486168575979807]]]),
        {
          "Class": "Upland_Evergreen",
          "system:index": "0"
        }),
    geometry85 = /* color: #00ff00 */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.087985156497, 17.50147529730719],
              [97.08990561815166, 17.501557154806644],
              [97.08992707582378, 17.504023094688367],
              [97.08770620675945, 17.503828685705532]]]),
        {
          "Class": "Upland_Evergreen",
          "system:index": "0"
        }),
    geometry86 = /* color: #0000ff */ee.Feature(
        ee.Geometry.Polygon(
            [[[97.09028112741375, 17.529105223688283],
              [97.09259855600261, 17.528982456055193],
              [97.09268438669109, 17.531550328406496],
              [97.0903455004301, 17.531591250380743]]]),
        {
          "Class": "Upland_Evergreen",
          "system:index": "0"
        });
var Palette = ['#008000', '#00FF00', '#808000', '#FFFF00', '#FF00FF', '6a2325', 'c3aa69']; //green, lime, olive,yellow,fuchsia

//Map.addLayer(image,{palette: Palette, min: 0, max: 3}, 'image');
//Map.addLayer(image2,{palette: Palette, min: 0, max: 3}, 'image2');

//----------------------------------------------------ROI--------------------------------------------

var state = ee.FeatureCollection(table2);
//print(state);

var roi = state;
Map.centerObject(roi,8);
//print(roi);

var empty = ee.Image().byte();
var outline_roi = empty.paint({
  featureCollection: roi,
  color: 'AREA',
  width: 4
});

var palette = ['FF0000'];
Map.addLayer(outline_roi, {palette: palette, max: 14}, 'different color edges');

var train =ee.FeatureCollection([geometry,geometry2,geometry3,geometry4,geometry5,
                                 geometry6,geometry7,geometry8,geometry9,geometry10,
                                 geometry11,geometry12,geometry13,geometry14,geometry15,
                                 geometry16,geometry17,geometry18,geometry19,geometry20,
                                 geometry21,geometry22,geometry23,geometry24,geometry25,
                                 geometry26,geometry27,geometry28,geometry29,geometry30,
                                 geometry31,geometry32,geometry33,geometry34,geometry35,
                                 geometry36,geometry37,geometry38,geometry39,geometry40,
                                 geometry41,geometry42,geometry43,geometry44,geometry45,
                                 geometry46,geometry47,geometry48,geometry49,geometry50,
                                 geometry51,geometry52,geometry53,geometry54,geometry55,
                                 geometry56,geometry57,geometry58,geometry59,geometry60,
                                 geometry61,geometry62,geometry63,geometry64,geometry65,
                                 geometry66,geometry67,geometry68,geometry69,geometry70,
                                 geometry71,geometry72,geometry73,geometry74,geometry75,
                                 geometry76,geometry77,geometry78,geometry79,geometry80,
                                 geometry81,geometry82,geometry83,geometry84,geometry85,
                                 geometry86]);
  
//print(train);

var training = train.remap(['Mangrove','MDF','Rubber', 'Coconut', 'Upland_Evergreen','Lowland_Evergreen', 'Bamboo'], [0, 1, 2, 3, 4, 5, 6], 'Class');
//print(training);

var mangrove = training.filter(ee.Filter.eq('Class', 0));
var mangrove_size = mangrove.size();
print(mangrove_size,'mangrove_size');

var mdf = training.filter(ee.Filter.eq('Class', 1));
var mdf_size = mdf.size();
print(mdf_size,'mdf_size');

var rubber = training.filter(ee.Filter.eq('Class', 2));
var rubber_size = rubber.size();
print(rubber_size,'rubber_size');

var coconut = training.filter(ee.Filter.eq('Class', 3));
var coconut_size = coconut.size();
print(coconut_size,'coconut_size');


var up_evg = training.filter(ee.Filter.eq('Class', 4));
var up_evg_size = up_evg.size();
print(up_evg_size,'up_evg_size');

var low_evg = training.filter(ee.Filter.eq('Class', 5));
print(low_evg.size());

var bamboo = training.filter(ee.Filter.eq('Class', 6));
print(bamboo.size());

var training= mangrove.merge(mdf).merge(rubber).merge(coconut).merge(up_evg).merge(low_evg).merge(bamboo);
print(training);


//----------------------------------------------------TP_PCT----------------------------------------------
//Load TP_PCT_Map
var tc = ee.Image(tcc);
var tc_gte25 = tc.gte(25);
//Map.addLayer(tc.clip(roi), {}, 'PCT');
//Map.addLayer(tc_gte25, {}, 'PCT25');

//---------------------------------------------------Rainfall----------------------------------------------
//Load CHIRPS data
//-----------------------------------------------------SRTM------------------------------------------------
// Load SRTM
var dataset = ee.Image('CGIAR/SRTM90_V4');
var elevation = dataset.select('elevation').unmask(0);
var slope = ee.Terrain.slope(elevation);

//Map.addLayer(dataset, {}, 'elevation');
//print(elevation);

var elev5m = elevation.lte(5);
//Map.addLayer(elev5m, {}, 'elev5m');
//-----------------------------------------------------GEDI-------------------------------------------
// Load GEDI
var gedi = ee.ImageCollection('users/potapovpeter/GEDI_V27');
//print(gedi);

var gedi_sasia= gedi.filterMetadata('system:index', 'equals', 'GEDI_SASIA_v27').first();
//print(gedi_sasia,"gedi_sasia");

var gedi_roi  = ee.Image(gedi_sasia).rename('ht');
//print(gedi_roi);
//Map.addLayer(gedi_roi.clip(roi), {min:0, max:25}, 'gedi_roi');


//----------------------------------------------------Radar--Processing---------------------------------------

function toDB(img) {
  return ee.Image(img).log10().multiply(10.0);
}

// The RL speckle filter
function RefinedLee(img) {
  // img must be in natural units, i.e. not in dB!
  // Set up 3x3 kernels 
  var weights3 = ee.List.repeat(ee.List.repeat(1,3),3);
  var kernel3 = ee.Kernel.fixed(3,3, weights3, 1, 1, false);

  var mean3 = img.reduceNeighborhood(ee.Reducer.mean(), kernel3);
  var variance3 = img.reduceNeighborhood(ee.Reducer.variance(), kernel3);

  // Use a sample of the 3x3 windows inside a 7x7 windows to determine gradients and directions
  var sample_weights = ee.List([[0,0,0,0,0,0,0], [0,1,0,1,0,1,0],[0,0,0,0,0,0,0], [0,1,0,1,0,1,0], [0,0,0,0,0,0,0], [0,1,0,1,0,1,0],[0,0,0,0,0,0,0]]);

  var sample_kernel = ee.Kernel.fixed(7,7, sample_weights, 3,3, false);

  // Calculate mean and variance for the sampled windows and store as 9 bands
  var sample_mean = mean3.neighborhoodToBands(sample_kernel); 
  var sample_var = variance3.neighborhoodToBands(sample_kernel);

  // Determine the 4 gradients for the sampled windows
  var gradients = sample_mean.select(1).subtract(sample_mean.select(7)).abs();
  gradients = gradients.addBands(sample_mean.select(6).subtract(sample_mean.select(2)).abs());
  gradients = gradients.addBands(sample_mean.select(3).subtract(sample_mean.select(5)).abs());
  gradients = gradients.addBands(sample_mean.select(0).subtract(sample_mean.select(8)).abs());

  // And find the maximum gradient amongst gradient bands
  var max_gradient = gradients.reduce(ee.Reducer.max());

  // Create a mask for band pixels that are the maximum gradient
  var gradmask = gradients.eq(max_gradient);

  // duplicate gradmask bands: each gradient represents 2 directions
  gradmask = gradmask.addBands(gradmask);

  // Determine the 8 directions
  var directions = sample_mean.select(1).subtract(sample_mean.select(4)).gt(sample_mean.select(4).subtract(sample_mean.select(7))).multiply(1);
  directions = directions.addBands(sample_mean.select(6).subtract(sample_mean.select(4)).gt(sample_mean.select(4).subtract(sample_mean.select(2))).multiply(2));
  directions = directions.addBands(sample_mean.select(3).subtract(sample_mean.select(4)).gt(sample_mean.select(4).subtract(sample_mean.select(5))).multiply(3));
  directions = directions.addBands(sample_mean.select(0).subtract(sample_mean.select(4)).gt(sample_mean.select(4).subtract(sample_mean.select(8))).multiply(4));
  // The next 4 are the not() of the previous 4
  directions = directions.addBands(directions.select(0).not().multiply(5));
  directions = directions.addBands(directions.select(1).not().multiply(6));
  directions = directions.addBands(directions.select(2).not().multiply(7));
  directions = directions.addBands(directions.select(3).not().multiply(8));

  // Mask all values that are not 1-8
  directions = directions.updateMask(gradmask);

  // "collapse" the stack into a singe band image (due to masking, each pixel has just one value (1-8) in it's directional band, and is otherwise masked)
  directions = directions.reduce(ee.Reducer.sum());  

  //var pal = ['ffffff','ff0000','ffff00', '00ff00', '00ffff', '0000ff', 'ff00ff', '000000'];
  //Map.addLayer(directions.reduce(ee.Reducer.sum()), {min:1, max:8, palette: pal}, 'Directions', false);

  var sample_stats = sample_var.divide(sample_mean.multiply(sample_mean));

  // Calculate localNoiseVariance
  var sigmaV = sample_stats.toArray().arraySort().arraySlice(0,0,5).arrayReduce(ee.Reducer.mean(), [0]);

  // Set up the 7*7 kernels for directional statistics
  var rect_weights = ee.List.repeat(ee.List.repeat(0,7),3).cat(ee.List.repeat(ee.List.repeat(1,7),4));

  var diag_weights = ee.List([[1,0,0,0,0,0,0], [1,1,0,0,0,0,0], [1,1,1,0,0,0,0], 
    [1,1,1,1,0,0,0], [1,1,1,1,1,0,0], [1,1,1,1,1,1,0], [1,1,1,1,1,1,1]]);

  var rect_kernel = ee.Kernel.fixed(7,7, rect_weights, 3, 3, false);
  var diag_kernel = ee.Kernel.fixed(7,7, diag_weights, 3, 3, false);

  // Create stacks for mean and variance using the original kernels. Mask with relevant direction.
  var dir_mean = img.reduceNeighborhood(ee.Reducer.mean(), rect_kernel).updateMask(directions.eq(1));
  var dir_var = img.reduceNeighborhood(ee.Reducer.variance(), rect_kernel).updateMask(directions.eq(1));

  dir_mean = dir_mean.addBands(img.reduceNeighborhood(ee.Reducer.mean(), diag_kernel).updateMask(directions.eq(2)));
  dir_var = dir_var.addBands(img.reduceNeighborhood(ee.Reducer.variance(), diag_kernel).updateMask(directions.eq(2)));

  // and add the bands for rotated kernels
  for (var i=1; i<4; i++) {
    dir_mean = dir_mean.addBands(img.reduceNeighborhood(ee.Reducer.mean(), rect_kernel.rotate(i)).updateMask(directions.eq(2*i+1)));
    dir_var = dir_var.addBands(img.reduceNeighborhood(ee.Reducer.variance(), rect_kernel.rotate(i)).updateMask(directions.eq(2*i+1)));
    dir_mean = dir_mean.addBands(img.reduceNeighborhood(ee.Reducer.mean(), diag_kernel.rotate(i)).updateMask(directions.eq(2*i+2)));
    dir_var = dir_var.addBands(img.reduceNeighborhood(ee.Reducer.variance(), diag_kernel.rotate(i)).updateMask(directions.eq(2*i+2)));
  }

  // "collapse" the stack into a single band image (due to masking, each pixel has just one value in it's directional band, and is otherwise masked)
  dir_mean = dir_mean.reduce(ee.Reducer.sum());
  dir_var = dir_var.reduce(ee.Reducer.sum());

  // A finally generate the filtered value
  var varX = dir_var.subtract(dir_mean.multiply(dir_mean).multiply(sigmaV)).divide(sigmaV.add(1.0));

  var b = varX.divide(dir_var);

  var result = dir_mean.add(b.multiply(img.subtract(dir_mean)));
  result= result.arrayFlatten([['sum']]);
  return(result);
}

//-----------------------------------------------------PALSAR-----------------------------------------------
//Load PALSAR

var palsar = ee.ImageCollection('JAXA/ALOS/PALSAR/YEARLY/SAR')
                  .filterBounds(roi)
                  .filterDate('2017-01-01', '2018-01-01')
                  .select('HH', 'HV');
//print(palsar,'PALSAR');

var pal_HH = palsar.select('HH');
//print(pal_HH, 'pal_HH');
//Map.addLayer(pal_HH, {},'pal_HH');

// Convert DN to gamma_nought in natural values

function toGamma(img) { 
  return ee.Image(img).pow(2).divide(ee.Number(10.0).pow(8.3));
}

var palsar_gn = palsar.map(function(img) { return ee.Image(img).pow(2).divide(ee.Number(10.0).pow(8.3))});

var pal_HH_gn = palsar_gn.select('HH').first();
var pal_HV_gn = palsar_gn.select('HV').first();
var pal_HH_HV = pal_HH_gn.divide(pal_HV_gn);

//Map.addLayer(pal_HH, {min:-25, max:0}, "pal_HH");


var pal_HH_urf = toDB(pal_HH_gn);
//print(pal_HH_urf,'pal_HH_urf');
//Map.addLayer(pal_HH_urf.clip(roi),{min:-25.0, max:0.0}, "pal_HH_urf");

var pal_HV_urf = toDB(pal_HV_gn);
//print(pal_HH_urf,'pal_HH_urf');
//Map.addLayer(pal_HH_urf.clip(roi),{min:-25.0, max:0.0}, "pal_HH_urf");


var pal_HH_rf = toDB(RefinedLee(pal_HH_gn)).rename('HH');
//print(pal_HH_rf,'pal_HH_rf');
//Map.addLayer(pal_HH_rf.clip(roi),{}, "pal_HH_rf");

var pal_HV_rf = toDB(RefinedLee(pal_HV_gn)).rename('HV');
//print(pal_HV_rf, 'pal_HV_rf');
//Map.addLayer(pal_HV_rf.clip(roi),{min:-25.0, max:0.0}, "pal_HV_rf");

var pal_HH_HV = (pal_HH_urf.divide(pal_HV_urf)).rename('HH_HV_urf');
//print(pal_HH_HV, 'pal_HH_HV');
//Map.addLayer(pal_HH_HV.clip(roi),{min:-1.0, max:1.0}, "pal_HH_HV");

var glcmHH = pal_HH_gn.unitScale(0,1).multiply(255).toByte().glcmTexture({size:3});
//print(glcmHH, 'glcmHH');

var glcmHV = pal_HV_gn.unitScale(0,1).multiply(255).toByte().glcmTexture({size:3});
var glcmHH_HV =pal_HH_HV.unitScale(0,1).multiply(255).toByte().glcmTexture({size:3});

var pal_variables = pal_HH_gn.addBands(pal_HV_gn).addBands(pal_HH_HV)
                             .addBands(glcmHH).addBands(glcmHV).addBands(glcmHH_HV);

//----------------------------------------------------Sentinel-1----------------------------------------------------
//Load Sentinel-1
var s1_col = ee.ImageCollection('COPERNICUS/S1_GRD')
                            .filterBounds(roi)
                            .filter(ee.Filter.eq('instrumentMode', 'IW'))
                            .filterDate('2016-05-01', '2020-04-30')
                            .filter(ee.Filter.listContains('transmitterReceiverPolarisation', 'VV'))
                            .filter(ee.Filter.listContains('transmitterReceiverPolarisation', 'VH'))
                            .filter(ee.Filter.eq('orbitProperties_pass', 'DESCENDING'));
                            
//print(s1_col, 'S1_col');

var s1_col_VV = s1_col.select('VV');
var s1_col_VH = s1_col.select('VH');

//Map.addLayer(S1_col.select('VV'), {}, 'S1_col');
//Map.addLayer(S1_col.select('VH'), {}, 'S1_col');

// Functions to convert from/to dB
function toNatural(img) {
  return ee.Image(10.0).pow(img.select(0).divide(10.0));
}

// convert sigma naught to gamma naught for S1

//function toGamma0(image) {
//  return image.select(1).subtract(image.select('angle').multiply(Math.PI/180.0).cos().log10().multiply(10.0));
//}

//Function applies Refined Lee to all images in collection

var s1_VV_rf = s1_col_VV.map(function(image){
  return toDB(RefinedLee(toNatural(image))).set("system:time_start", image.get('system:time_start'));
});

//print(s1_VV_rf, "s1_VV_rf");

//1 month VV composite from speckle filtered images

var months = ee.List.sequence(1, 12, 1);
//print(months);
var mon = ee.List(['January','February','March','April','May','June','July','August','September','October','November','December']);
var s1_VV_mon_composites = months.map(function(m) {
  var n = ee.Number(m).subtract(1);
  var s1_VV_image = s1_col_VV.filter(ee.Filter.calendarRange({
    start: m, 
    end: ee.Number(m).add(0), 
    field: 'month'
  })).median()
  .set('month', mon.get(n))
  .select(0).rename('VV_rf');
  
  var glcmVV = (s1_VV_image.select(0)).unitScale(0,1).multiply(255).toByte().glcmTexture({size:3});
  
  return s1_VV_image.addBands(glcmVV).float();
});

//print(s1_VV_mon_composites, "s1_VV_mon_composites");
//print(s1_VV_mon_composites.get(0),"s1_VV_mon_composites.get(0)");

var s1_VV_variables = ee.Image(s1_VV_mon_composites.get(0))
                                           .addBands(ee.Image(s1_VV_mon_composites.get(1)))
                                           .addBands(ee.Image(s1_VV_mon_composites.get(2)))
                                           .addBands(ee.Image(s1_VV_mon_composites.get(3)))
                                           .addBands(ee.Image(s1_VV_mon_composites.get(4)))
                                           .addBands(ee.Image(s1_VV_mon_composites.get(5)))
                                           .addBands(ee.Image(s1_VV_mon_composites.get(6)))
                                           .addBands(ee.Image(s1_VV_mon_composites.get(7)))
                                           .addBands(ee.Image(s1_VV_mon_composites.get(8)))
                                           .addBands(ee.Image(s1_VV_mon_composites.get(9)))
                                           .addBands(ee.Image(s1_VV_mon_composites.get(10)))
                                           .addBands(ee.Image(s1_VV_mon_composites.get(11)));


var s1_VH_rf = s1_col_VH.map(function(image){
  return toDB(RefinedLee(toNatural(image))).set("system:time_start", image.get('system:time_start'));
});

//print(s1_VH_rf, "s1_VH_rf");


//1 month VH composite from speckle filtered images

var months = ee.List.sequence(1, 12, 1);
//print(months);
var mon = ee.List(['January','February','March','April','May','June','July','August','September','October','November','December']);
var s1_VH_mon_composites = months.map(function(m) {
  var n = ee.Number(m).subtract(1);
  var s1_VH_image = s1_col_VH.filter(ee.Filter.calendarRange({
    start: m, 
    end: ee.Number(m).add(0), 
    field: 'month'
  })).median()
  .set('month', mon.get(n));
  
  var glcmVH = (s1_VH_image.select(0)).unitScale(0,1).multiply(255).toByte().glcmTexture({size:3});
  
  return s1_VH_image.addBands(glcmVH).float();
});

//print(s1_VH_mon_composites, "s1_VH_mon_composites");
//print(s1_VH_mon_composites.get(0),"s1_VH_mon_composites.get(0)");

var s1_VH_variables = ee.Image(s1_VH_mon_composites.get(0))
                                           .addBands(ee.Image(s1_VH_mon_composites.get(1)))
                                           .addBands(ee.Image(s1_VH_mon_composites.get(2)))
                                           .addBands(ee.Image(s1_VH_mon_composites.get(3)))
                                           .addBands(ee.Image(s1_VH_mon_composites.get(4)))
                                           .addBands(ee.Image(s1_VH_mon_composites.get(5)))
                                           .addBands(ee.Image(s1_VH_mon_composites.get(6)))
                                           .addBands(ee.Image(s1_VH_mon_composites.get(7)))
                                           .addBands(ee.Image(s1_VH_mon_composites.get(8)))
                                           .addBands(ee.Image(s1_VH_mon_composites.get(9)))
                                           .addBands(ee.Image(s1_VH_mon_composites.get(10)))
                                           .addBands(ee.Image(s1_VH_mon_composites.get(11)));
                                           

//--------------------------------------------------- Sentinel-2------------------------------------------------------

//Load Sentinel-2 SR
// Function to mask clouds using the Sentinel-2 QA band
// @param {ee.Image} image Sentinel-2 image
// @return {ee.Image} cloud masked Sentinel-2 image
 //
function maskS2clouds(image) {
  var qa = image.select('QA60');

  // Bits 10 and 11 are clouds and cirrus, respectively.
  var cloudBitMask = 1 << 10;
  var cirrusBitMask = 1 << 11;

  // Both flags should be set to zero, indicating clear conditions.
  var mask = qa.bitwiseAnd(cloudBitMask).eq(0)
      .and(qa.bitwiseAnd(cirrusBitMask).eq(0));
  var prop = image.toDictionary();

  return image.updateMask(mask).divide(10000).set("system:time_start", image.get('system:time_start'));
}

var s2collection = ee.ImageCollection('COPERNICUS/S2_SR')
                  .filterBounds(roi)
                  .filterDate('2015-05-01', '2020-04-30')
                  .filter(ee.Filter.lt('CLOUDY_PIXEL_PERCENTAGE',50))
                  .map(maskS2clouds)
                  .select('B[2-8]', 'B8A', 'B11', 'B12');
//print(s2collection.first());
//print(s2collection.size());

var s2_med = s2collection.median();
//Map.addLayer(s2_med, {min: 0.0, max: 0.3,bands: ['B11', 'B8', 'B3']}, 's2_med');
var s2_med_ndvi =s2_med.normalizedDifference(['B8A', 'B4']);
var s2_water_mask =s2_med_ndvi.lte(0);

//Map.addLayer(s2_water_mask.clip(roi), {}, "s2_water_mask");

//1 month composite

var months = ee.List.sequence(1, 12, 1);
//print(months);
var mon = ee.List(['January','February','March','April','May','June','July','August','September','October','November','December']);
var s2_mon_composites = months.map(function(m) {
  var n = ee.Number(m).subtract(1);
  var s2_img_all_10m = s2collection.filter(ee.Filter.calendarRange({
    start: m, 
    end: ee.Number(m).add(0), 
    field: 'month'
  })).median()
  .set('month', mon.get(n));

  return s2_img_all_10m.float();
});

// Map the function over the collection and display the result.
//print(s2_mon_composites,'s2_mon_composites');

var check0 = ee.Image(s2_mon_composites.get(0));
var check1 = ee.Image(s2_mon_composites.get(1));
var check2 = ee.Image(s2_mon_composites.get(2));
var check3 = ee.Image(s2_mon_composites.get(3));
var check4 = ee.Image(s2_mon_composites.get(4));
var check5 = ee.Image(s2_mon_composites.get(5));
var check6 = ee.Image(s2_mon_composites.get(6));
var check7 = ee.Image(s2_mon_composites.get(7));
var check8 = ee.Image(s2_mon_composites.get(8));
var check9 = ee.Image(s2_mon_composites.get(9));
var check10 = ee.Image(s2_mon_composites.get(10));
var check11 = ee.Image(s2_mon_composites.get(11));

//Map.addLayer(check0, {min: 0.0, max: 0.3,bands: ['B11', 'B8', 'B3']}, 'checkjan');
//Map.addLayer(check1, {min: 0.0, max: 0.3,bands: ['B11', 'B8', 'B3']}, 'checkfeb');
//Map.addLayer(check2, {min: 0.0, max: 0.3,bands: ['B11', 'B8', 'B3']}, 'checkmar');
Map.addLayer(check3, {min: 0.0, max: 0.3,bands: ['B11', 'B8', 'B3']}, 'checkapr');
Map.addLayer(check10, {min: 0.0, max: 0.3,bands: ['B11', 'B8', 'B3']}, 'checknov');
//Map.addLayer(check11, {min: 0.0, max: 0.3,bands: ['B11', 'B8', 'B3']}, 'checkdec');

var comp_list = ee.List([check0,check1,check2,check3,check10,check11]);

var image_indices = ee.List([]);
var i;
for (i = 0; i < 6; i++) {
  var image = ee.Image(comp_list.get(i));
  
  var b2 = image.select('B2');
  var b3 = image.select('B3');
  var b4 = image.select('B4');
  var b5 = image.select('B5');
  var b6 = image.select('B6');
  var b7 = image.select('B7');
  var b8 = image.select('B8');
  var b8a = image.select('B8A');
  var b11 = image.select('B11');
  var b12 = image.select('B12');
  var si_1 = (b2.divide(b3).rename('SI_1'));
  var si_2 = (b2.divide(b4).rename('SI_2'));
  var si_3 = (b2.divide(b5).rename('SI_3'));
  var si_4 = (b2.divide(b6).rename('SI_4'));
  var si_5 = (b2.divide(b7).rename('SI_5'));
  var si_6 = (b2.divide(b8).rename('SI_6'));
  var si_7 = (b2.divide(b8a).rename('SI_7'));
  var si_8 = (b2.divide(b11).rename('SI_8'));
  var si_9 = (b2.divide(b12).rename('SI_9'));
  
  var si_10 = (b3.divide(b4).rename('SI_10'));
  var si_11 = (b3.divide(b5).rename('SI_11'));
  var si_12 = (b3.divide(b6).rename('SI_12'));
  var si_13 = (b3.divide(b7).rename('SI_13'));
  var si_14 = (b3.divide(b8).rename('SI_14'));
  var si_15 = (b3.divide(b8a).rename('SI_15'));
  var si_16 = (b3.divide(b11).rename('SI_16'));
  var si_17 = (b3.divide(b12).rename('SI_17'));
  
  var si_18 = (b4.divide(b5).rename('SI_18'));
  var si_19 = (b4.divide(b6).rename('SI_19'));
  var si_20 = (b4.divide(b7).rename('SI_20'));
  var si_21 = (b4.divide(b8).rename('SI_21'));
  var si_22 = (b4.divide(b8a).rename('SI_22'));
  var si_23 = (b4.divide(b11).rename('SI_23'));
  var si_24 = (b4.divide(b12).rename('SI_24'));
  
  var si_25 = (b5.divide(b6).rename('SI_25'));
  var si_26 = (b5.divide(b7).rename('SI_26'));
  var si_27 = (b5.divide(b8).rename('SI_27'));
  var si_28 = (b5.divide(b8a).rename('SI_28'));
  var si_29 = (b5.divide(b11).rename('SI_29'));
  var si_30 = (b5.divide(b12).rename('SI_30'));
  
  var si_31 = (b6.divide(b7).rename('SI_31'));
  var si_32 = (b6.divide(b8).rename('SI_32'));
  var si_33 = (b6.divide(b8a).rename('SI_33'));
  var si_34 = (b6.divide(b11).rename('SI_34'));
  var si_35 = (b6.divide(b12).rename('SI_35'));
    
  var si_36 = (b7.divide(b8).rename('SI_36'));
  var si_37 = (b7.divide(b8a).rename('SI_37'));
  var si_38 = (b7.divide(b11).rename('SI_38'));
  var si_39 = (b7.divide(b12).rename('SI_39'));
    
  var si_40 = (b8.divide(b8a).rename('SI_40'));
  var si_41 = (b8.divide(b11).rename('SI_41'));
  var si_42 = (b8.divide(b12).rename('SI_42'));
    
  var si_43 = (b8a.divide(b11).rename('SI_43'));
  var si_44 = (b8a.divide(b12).rename('SI_44'));
    
  var si_45 = (b11.divide(b12).rename('SI_45'));
    

  var nd_1 = image.normalizedDifference(['B3', 'B2']).rename('ND_1');
  var nd_2 = image.normalizedDifference(['B4', 'B2']).rename('ND_2');
  var nd_3 = image.normalizedDifference(['B8A', 'B2']).rename('ND_3');
  var nd_4 = image.normalizedDifference(['B4', 'B3']).rename('ND_4');
  var nd_5 = image.normalizedDifference(['B8A', 'B3']).rename('ND_5');
    
  var nd_6 = image.normalizedDifference(['B5', 'B2']).rename('ND_6');
  var nd_7 = image.normalizedDifference(['B6', 'B2']).rename('ND_7');
  var nd_8 = image.normalizedDifference(['B7', 'B2']).rename('ND_8');
  var nd_9 = image.normalizedDifference(['B8', 'B2']).rename('ND_9');
  var nd_10 = image.normalizedDifference(['B11', 'B2']).rename('ND_10');
  var nd_11 = image.normalizedDifference(['B12', 'B2']).rename('ND_11');
  
  var nd_12 = image.normalizedDifference(['B5', 'B3']).rename('ND_12');
  var nd_13 = image.normalizedDifference(['B6', 'B3']).rename('ND_13');
  var nd_14 = image.normalizedDifference(['B7', 'B3']).rename('ND_14');
  var nd_15 = image.normalizedDifference(['B8', 'B3']).rename('ND_15');
  var nd_16 = image.normalizedDifference(['B11', 'B3']).rename('ND_16');
  var nd_17 = image.normalizedDifference(['B12', 'B3']).rename('ND_17');
    
  var nd_18 = image.normalizedDifference(['B5', 'B4']).rename('ND_18');
  var nd_19 = image.normalizedDifference(['B6', 'B4']).rename('ND_19');
  var nd_20 = image.normalizedDifference(['B7', 'B4']).rename('ND_20');
  var nd_21 = image.normalizedDifference(['B8', 'B4']).rename('ND_21');
  var nd_22 = image.normalizedDifference(['B11', 'B4']).rename('ND_22');
  var nd_23 = image.normalizedDifference(['B12', 'B4']).rename('ND_23');
  var nd_24 = image.normalizedDifference(['B6', 'B5']).rename('ND_24');
  var nd_25 = image.normalizedDifference(['B7', 'B5']).rename('ND_25');
  var nd_26 = image.normalizedDifference(['B8A', 'B5']).rename('ND_26');
  var nd_27 = image.normalizedDifference(['B8', 'B5']).rename('ND_27');
  var nd_28 = image.normalizedDifference(['B11', 'B5']).rename('ND_28');
  var nd_29 = image.normalizedDifference(['B12', 'B5']).rename('ND_29');
  
  var nd_30 = image.normalizedDifference(['B7', 'B6']).rename('ND_30');
  var nd_31 = image.normalizedDifference(['B8A', 'B6']).rename('ND_31');
  var nd_32 = image.normalizedDifference(['B8', 'B6']).rename('ND_32');
  var nd_33 = image.normalizedDifference(['B11', 'B6']).rename('ND_33');
  var nd_34 = image.normalizedDifference(['B12', 'B6']).rename('ND_34');
  
  var nd_35 = image.normalizedDifference(['B8A', 'B7']).rename('ND_35');
  var nd_36 = image.normalizedDifference(['B8', 'B7']).rename('ND_36');
  var nd_37 = image.normalizedDifference(['B11', 'B7']).rename('ND_37');
  var nd_38 = image.normalizedDifference(['B12', 'B7']).rename('ND_38');
    
  var nd_39 = image.normalizedDifference(['B8', 'B8A']).rename('ND_39');
  var nd_40 = image.normalizedDifference(['B11', 'B8A']).rename('ND_40');
  var nd_41 = image.normalizedDifference(['B12', 'B8A']).rename('ND_41');
    
  var nd_42 = image.normalizedDifference(['B11', 'B8']).rename('ND_42');
  var nd_43 = image.normalizedDifference(['B12', 'B8']).rename('ND_43');
    
  var nd_44 = image.normalizedDifference(['B12', 'B11']).rename('ND_44');
      

  
  var ndvi = image.normalizedDifference(['B8A', 'B4']).rename('NDVI');
    
  var evi = image.expression('2.5 * ((nir - red) / (nir + 6 * red - 7.5 * blue + 1))',{
       'nir': image.select('B8A'), 'red': image.select('B4'), 'blue': image.select('B2')});
    
    
  var savi = image.expression('1.5 * ((nir - red) / (nir + red + 0.5))',{
    'nir': image.select('B8A'), 'red': image.select('B4')});
        
  var wri = (b3.add(b4).divide(b8a.add(b11)).rename('WRI'));
    
  var awei = image.expression('4 * (green - swir1) - (0.25 * nir + 2.75 * swir1)',{
    'green': image.select('B3'), 'swir1': image.select('B11'), 'nir': image.select('B8A')});
  
  var ccci = image.expression('((nir - vre1) / (nir + vre2)) / ((nir - red) / (nir + red))', {
      'nir': image.select('B8A'), 'red': image.select('B4'),'vre1': image.select('B5'), 
      'vre2': image.select('B6')});
      
  var s2rep = image.expression('705.0 + 35.0 * ((((red + vre3) / 2.0) - vre1) / (vre2 - vre1))',{
    'red': image.select('B4'),'vre1': image.select('B5'), 'vre2': image.select('B6'),
    'vre3': image.select('B7')});
    
  var ireci = image.expression('(nir - red)/(vre1/vre2)', { 
    'nir': image.select('B8A'), 'red': image.select('B4'),'vre1': image.select('B5'), 
    'vre2': image.select('B6')});

  
  var glcm_b = b2.multiply(255).int().glcmTexture({size:3});
  var glcm_g = b3.multiply(255).int().glcmTexture({size:3});
  var glcm_r = b4.multiply(255).int().glcmTexture({size:3});
  var glcm_nir = b8.multiply(255).int().glcmTexture({size:3});
  var glcm_swir1 = b11.multiply(255).int().glcmTexture({size:3});
  var glcm_swir2 = b12.multiply(255).int().glcmTexture({size:3});
  var glcm_vre1 = b5.multiply(255).int().glcmTexture({size:3});
  var glcm_vre2 = b6.multiply(255).int().glcmTexture({size:3});
  var glcm_vre3 = b7.multiply(255).int().glcmTexture({size:3});
  var glcm_nnir = b8a.multiply(255).int().glcmTexture({size:3});
  
 
  var image = image
               .addBands(si_1)
               .addBands(si_2)
               .addBands(si_3)
               .addBands(si_4)
               .addBands(si_5)
               .addBands(si_6)
              
               .addBands(si_7)
               .addBands(si_8)
               .addBands(si_9)
               .addBands(si_10)
              
               .addBands(si_11)
               .addBands(si_12)
             
               
               .addBands(si_13)
               .addBands(si_14)
               .addBands(si_15)
               .addBands(si_16)
              
               .addBands(si_17)
               .addBands(si_18)
               
               
               .addBands(si_19)
               .addBands(si_20)
               .addBands(si_21)
               .addBands(si_22)
             
               .addBands(si_23)
               .addBands(si_24)
               
               
               .addBands(si_25)
               .addBands(si_26)
               .addBands(si_27)
               .addBands(si_28)
               
               .addBands(si_31)
               .addBands(si_32)
               .addBands(si_33)
               .addBands(si_34)
               .addBands(si_35)
               .addBands(si_36)
               .addBands(si_37)
               .addBands(si_38)
               .addBands(si_39)
               .addBands(si_40)
               
               .addBands(si_41)
               .addBands(si_42)
               
               .addBands(si_43)
               .addBands(si_44)
               
               .addBands(si_45)
               .addBands(nd_1)
               .addBands(nd_2)
               .addBands(nd_3)
               .addBands(nd_4)
               .addBands(nd_5)
              
               .addBands(nd_6)
               .addBands(nd_7)
               .addBands(nd_8)
               .addBands(nd_9)
             
               .addBands(nd_10)
               .addBands(nd_11)
               
               .addBands(nd_12)
               .addBands(nd_13)
               .addBands(nd_14)
               .addBands(nd_15)
              
               .addBands(nd_16)
               .addBands(nd_17)
               
               
               .addBands(nd_18)
               .addBands(nd_19)
               .addBands(nd_20)
               .addBands(nd_21)
              
               .addBands(nd_22)
               .addBands(nd_23)
               
               .addBands(nd_24)
               .addBands(nd_25)
               .addBands(nd_26)
               .addBands(nd_27)
               .addBands(nd_28)
               .addBands(nd_29)
               .addBands(nd_30)
               .addBands(nd_31)
               .addBands(nd_32)
               .addBands(nd_33)
               .addBands(nd_34)
               .addBands(nd_35)
               .addBands(nd_36)
               .addBands(nd_37)
               .addBands(nd_38)
               .addBands(nd_39)
               
               .addBands(nd_40)
               .addBands(nd_41)
               
               .addBands(nd_42)
               .addBands(nd_43)
               
               .addBands(nd_44)
               .addBands(ndvi)
               .addBands(evi.rename('EVI'))
               .addBands(savi.rename('SAVI'))
               .addBands(wri)
               .addBands(awei.rename('AWEI'))
               
               .addBands(ccci.rename('CCC1'))
               .addBands(s2rep.rename('S2REP'))
               .addBands(ireci.rename('IRECI'))
               
               .addBands(glcm_b)
               .addBands(glcm_g)
               .addBands(glcm_r)
               .addBands(glcm_nir)
               .addBands(glcm_swir1)
               .addBands(glcm_swir2)
               
               .addBands(glcm_vre1)
               .addBands(glcm_vre2)
               .addBands(glcm_vre3)
               .addBands(glcm_nnir);
  //print(image,i);
  
  var image_indices = image_indices.add(image);
}

//print(image_indices);

//Monthly NDVI

var Jan_composite = ee.Image(image_indices.get(0));
var Jan_ndvi = Jan_composite.select ("NDVI");
var Jan_ndvi_mask = Jan_ndvi.gte(0.5);

var Feb_composite = ee.Image(image_indices.get(1));
var Feb_ndvi = Feb_composite.select ("NDVI");
var Feb_ndvi_mask = Feb_ndvi.gte(0.5);

var Mar_composite = ee.Image(image_indices.get(2));
var Mar_ndvi = Mar_composite.select ("NDVI");
var Mar_ndvi_mask = Mar_ndvi.gte(0.5);

var Apr_composite = ee.Image(image_indices.get(3));
var Apr_ndvi = Apr_composite.select ("NDVI");
var Apr_ndvi_mask = Apr_ndvi.gte(0.5);

var Nov_composite = ee.Image(image_indices.get(4));
var Nov_ndvi = Nov_composite.select ("NDVI");
var Nov_ndvi_mask = Nov_ndvi.gte(0.5);

var Dec_composite = ee.Image(image_indices.get(5));
var Dec_ndvi = Dec_composite.select ("NDVI");
var Dec_ndvi_mask = Dec_ndvi.gte(0.5);

var six_month_ndvi = Jan_ndvi_mask.add(Feb_ndvi_mask).add(Mar_ndvi_mask)
                                  .add(Apr_ndvi_mask).add(Nov_ndvi_mask).add(Dec_ndvi_mask);

var nf_mask = six_month_ndvi.gte(6);                  
//print(nf_mask,{},"nf_mask");
//Map.addLayer(nf_mask.updateMask(nf_mask), {},"nf_mask");

var forest1 = tc_gte25.unmask(0);
//Map.addLayer(forest1.updateMask(forest1), {},"forest1");

var forest2 = nf_mask.eq(1).unmask(0);
//Map.addLayer(forest2.updateMask(forest2), {},"forest2");

//var forest3 = tp_fe_0.eq(1).unmask(0);
//Map.addLayer(forest3.updateMask(forest3), {},"forest3");

var forest = forest1.add(forest2);
forest= forest.gte(1);
Map.addLayer(forest.updateMask(forest), {},"forest");



var evg = Jan_ndvi.gte(0.7).and(Feb_ndvi.gte(0.7))
                           .and(Mar_ndvi.gte(0.7))
                           .and(Apr_ndvi.gte(0.7))
                           .and(Nov_ndvi.gte(0.7))
                           .and(Dec_ndvi.gte(0.7));
                           
//Map.addLayer(evg.updateMask(evg), {},'evg');

var area_mask = ee.Image.constant(1).clip(table3).mask().not();

/*
//Monthly water NDVI

var Jan_composite = ee.Image(image_indices.get(0));
var Jan_ndvi = Jan_composite.select ("NDVI");
var Jan_ndvi_mask = Jan_ndvi.lte(0);
Map.addLayer(Jan_ndvi,{}, "Jan_ndvi");

var Feb_composite = ee.Image(image_indices.get(1));
var Feb_ndvi = Feb_composite.select ("NDVI");
var Feb_ndvi_mask = Feb_ndvi.lte(0);
Map.addLayer(Feb_ndvi,{}, "Feb_ndvi");

var Mar_composite = ee.Image(image_indices.get(2));
var Mar_ndvi = Mar_composite.select ("NDVI");
var Mar_ndvi_mask = Mar_ndvi.lte(0);
Map.addLayer(Mar_ndvi,{}, "Mar_ndvi");

var Apr_composite = ee.Image(image_indices.get(3));
var Apr_ndvi = Apr_composite.select ("NDVI");
Map.addLayer(Apr_ndvi.clip(roi),{}, "Apr_ndvi");
var Apr_ndvi_mask = Apr_ndvi.lte(0);


var Nov_composite = ee.Image(image_indices.get(4));
var Nov_ndvi = Nov_composite.select ("NDVI");
var Nov_ndvi_mask = Nov_ndvi.lte(0);
Map.addLayer(Nov_ndvi,{}, "Nov_ndvi");

var Dec_composite = ee.Image(image_indices.get(5));
var Dec_ndvi = Dec_composite.select ("NDVI");
Map.addLayer(Dec_ndvi.clip(roi),{}, "Dec_ndvi");

var Dec_ndvi_mask = Dec_ndvi.lte(0);
Map.addLayer(Dec_ndvi_mask,{}, "Dec_ndvi_mask");

var six_month_water_ndvi = Jan_ndvi_mask.add(Feb_ndvi_mask).add(Mar_ndvi_mask)
                                  .add(Apr_ndvi_mask).add(Nov_ndvi_mask).add(Dec_ndvi_mask);

var water_mask = six_month_water_ndvi.gte(1);                  
print(water_mask,{},"water_mask");
//Map.addLayer(water_mask.clip(roi), {}, "water_mask");

//var del_ndvi = Mar_ndvi.subtract(Apr_ndvi);
//var del_10_ndvi =del_ndvi.gte(10);
//Map.addLayer(del_10_ndvi.clip(roi), {}, "del_10_ndvi");


//flooded mangrove


var Jan_mangrove_mask = Jan_ndvi.gte(0.5);
var Feb_mangrove_mask = Feb_ndvi.gte(0.5);
var Mar_mangrove_mask = Mar_ndvi.gte(0.3);
var Apr_mangrove_mask = Apr_ndvi.gte(0.3);
var Nov_mangrove_mask = Nov_ndvi.gte(0.2);
var Dec_mangrove_mask = Dec_ndvi.gte(0.5);
var mangrove_mask = Jan_mangrove_mask.and(Feb_mangrove_mask).add(Mar_mangrove_mask)
                                  .add(Apr_mangrove_mask).add(Nov_mangrove_mask).add(Dec_mangrove_mask);

//Map.addLayer(mangrove_mask, {}, "mangrove");
/**/


//---------------------------------------------------Build-Classification-Composite---------------------------------------

// convert list of images to single image
var class_composite = ee.Image(image_indices.get(0)).addBands(image_indices.get(1))
                                                    .addBands(image_indices.get(2))
                                                    .addBands(image_indices.get(3))
                                                    .addBands(image_indices.get(4))
                                                    .addBands(image_indices.get(5))
                                                    .addBands(gedi_roi)
                                                    .addBands(pal_variables)
                                                    .addBands(s1_VV_variables)
                                                    .addBands(s1_VH_variables)
                                                    .addBands(elevation)
                                                    .addBands(slope)
                                                    .updateMask(forest)
                                                    .updateMask(area_mask);
//print(class_composite);
var bands = class_composite.bandNames();
Map.addLayer(class_composite, {}, 'class_composite');
//Set1- IV gte 3 for polygons 1-25.
/*
var sel_bands =["elevation","B6_dent_5","B8_idm_5","B8A_diss_5","B12_savg_5",
"B8_diss_5","B6_dvar_5","B6_contrast_5","B11_savg_3","B11_2","B11_3","B6_inertia_5",
"ND_16_2","AWEI_2","B8A_idm_5","B8_dent_2","ND_28_2","ND_25","B7_diss_5","AWEI_5",
"B11_savg_5","B4_savg","B8A_inertia_5","B11_savg_4","B8_idm_3","B6_diss_5","AWEI_3",
"B3_inertia_1","HH_var","SI_25","ND_17_2","B12_savg_3","B7_contrast_5"];

//Set2-same bands as Set1 but more training pixels. (50 polygons)
//Set3-same as Set2. Only masked value= 100
/**/
var sel_bands =['B5_savg_3','B2_dent_3','ND_7','B4_savg_3','B2_inertia_3','B2_idm_3','B2_3','B2_dvar_3','SI_7',
'B2_savg_3','SI_8','ND_3','B4_dvar_3','B12_savg_3','ND_10','B4_prom_3','B2_contrast_3','B4_contrast_3','B4_imcorr1_3',
'B11_inertia_5','B2_ent_3','B11_savg_3','B11_dent','B4_svar_3','B5_savg_2','B4_savg_2','SI_4_3','SI_12_3','ND_13_3',
'B12_diss_5','B3_savg_3','SI_5_3','B4_3','SI_8_3','B11_dvar','B8_ent_4','B4_dent_3','SI_5','B5_diss_5','B3_3',
'SI_15_3','HH_diss','B7_savg_2','B11_diss','B11_contrast_4','SI_1','B4_var_3','SI_14_3','B11_asm_5','B7_dent'];
print(sel_bands);

//----------------------------------------------------Train--Classifier----------------------------------------------------

//Training

var training = class_composite.select(sel_bands).sampleRegions({
      // Get the sample from the polygons FeatureCollection.
      collection: training,
      // Keep this list of properties from the polygons.
      properties: ['Class'],
      // Set the scale to get Sentinel pixels in the polygons.
      scale: 20,
      tileScale:16
      });
//print(training.limit(10));
print(training.size());

var mangrove = (training.filter(ee.Filter.eq('Class', 0))).limit(500);//.limit(30);
print(mangrove.size(),'mangrove_size');

var mdf = (training.filter(ee.Filter.eq('Class', 1))).limit(200);//.limit(30);
print(mdf.size(),'mdf_size');

var rubber = (training.filter(ee.Filter.eq('Class', 2))).limit(1000);//.limit(30);
print(rubber.size(),'rubber_size');

var coconut = (training.filter(ee.Filter.eq('Class', 3))).limit(20);//.limit(30);
print(coconut.size(),'coconut_size');

var up_evg = (training.filter(ee.Filter.eq('Class', 4))).limit(1600);//.limit(30);
print(up_evg.size(),'up_evg_size');

low_evg = (training.filter(ee.Filter.eq('Class', 5))).limit(100);//.limit(30);
print(low_evg.size(),'low_evg_size');

bamboo = training.filter(ee.Filter.eq('Class', 6)).limit(500);
print(bamboo.size(), 'Bamboo');



var training2= mangrove.merge(mdf).merge(rubber).merge(coconut).merge(up_evg).merge(low_evg).merge(bamboo);
print(training2.size());

var classifier = ee.Classifier.smileRandomForest(500)
                .train({
                  features: training2, 
                  classProperty:'Class', 
                  inputProperties:sel_bands ,
                });
                
var dict = classifier.explain();
//print('Explain:',dict);    


var variable_importance = ee.FeatureCollection(ee.Feature(null, ee.Dictionary(dict).get('importance')));

/*
var chart =ui.Chart.feature.byProperty(variable_importance)
.setChartType('ColumnChart')
.setOptions({
title: 'Random Forest Variable Importance',
legend: {position: 'none'},
hAxis: {title: 'Bands'},
vAxis: {title: 'Importance'}
});
 
print(chart);
/**/

//----------------------------------------------Export--Important--Variables-------------------------------------------


// Export the FeatureCollection to a KML file.
Export.table.toDrive({
  collection: variable_importance,
  description:'RF_IV_Mon',
  fileFormat: 'CSV'
});


//----------------------------------------------Generate--Classified--Map-----------------------------------------


var classified = class_composite.classify(classifier).unmask(100);
           // Define a palette from the IGBP classification.

//var Palette = ['152106', '225129', '369b47', '30eb5b', '387242', '6a2325', 'c3aa69'];

var Palette = ['#008000', '#00FF00', '#808000', '#FFFF00', '#FF00FF', '6a2325', 'c3aa69']; //green, lime, olive,yellow,fuchsia

          
Map.addLayer(classified, {palette: Palette, min: 0, max: 6}, 'classification');

//Map.addLayer(nf_mask, {}, "nf_mask");

//var mangrove = nf_mask.eq(1).and(classified.eq(0));
//Map.addLayer(mangrove, {}, "mangrove");

//---------------------------------------------Export---Maps--------------------------------------------------------

// Export the image, specifying scale and region.
Export.image.toDrive({
  image: classified,
  description: 'classified_Mon_Set15',
  scale: 20,
  region: roi,
  maxPixels:375582411
});



// Export the image, specifying scale and region.
Export.image.toDrive({
  image: nf_mask,
  description: 'nf_mask',
  scale: 20,
  region: roi,
  fileFormat: 'GeoTIFF',
  maxPixels:375582411
});

/**/
